input {

  kafka {
    # kafka 配置
    bootstrap_servers => ["192.168.1.218:32770,192.168.1.218:32771"]
    consumer_threads => 1
    topics => ["kafka_topic"]
    auto_offset_reset => "earliest"
    auto_commit_interval_ms => 1000
  }
}

# 这里可以对数据过滤，增删改字段，格式化等
# filter {
#}

output {
#	elasticsearch {
#		hosts => "elasticsearch:9200"
#		user => "elastic"
#		password => "changeme"
#		ecs_compatibility => disabled
#	}

   # 输出 es，这的 filetype 就是在 filebeat 那边新增的自定义字段名
   if [filetype] == "djangoapp_all" {
     elasticsearch {
        hosts => "elasticsearch:9200"
        user => "elastic"
		password => "changeme"
		ecs_compatibility => disabled
        index => "djangoapp_all-%{+YYYY.MM.dd}"
    }
   } else if [filetype] == "djangoapp_print" {
     elasticsearch {
        hosts => "elasticsearch:9200"
        user => "elastic"
		password => "changeme"
		ecs_compatibility => disabled
        index => "djangoapp_print-%{+YYYY.MM.dd}"
    }
   } else if [filetype] == "djangoapp_req_res" {
     elasticsearch {
        hosts => "elasticsearch:9200"
        user => "elastic"
		password => "changeme"
		ecs_compatibility => disabled
        index => "djangoapp_req_res-%{+YYYY.MM.dd}"
    }
   } else if [filetype] == "djangoapp_exception" {
     elasticsearch {
        hosts => "elasticsearch:9200"
        user => "elastic"
		password => "changeme"
		ecs_compatibility => disabled
        index => "djangoapp_exception-%{+YYYY.MM.dd}"
    }
   }
}
